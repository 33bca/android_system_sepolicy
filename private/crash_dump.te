typeattribute crash_dump coredomain;

allow crash_dump {
  domain
  -bpfloader
  -crash_dump
  -init
  -kernel
  -keystore
  -logd
  -ueventd
  -vendor_init
  -vold
}:process { ptrace signal sigchld sigstop sigkill };

neverallow crash_dump {
  bpfloader
  init
  kernel
  keystore
  logd
  userdebug_or_eng(`-logd')
  ueventd
  vendor_init
  vold
}:process { ptrace signal sigstop sigkill };
